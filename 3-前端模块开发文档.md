# 前端模块开发文档

## 📌 模块概述

前端提供用户交互界面，实现与 MetaMask 钱包的连接、智能合约的调用、以及业务流程的可视化展示。

---

## 🎯 开发目标

- 提供简洁美观的用户界面
- 实现 MetaMask 钱包连接和账户管理
- 封装智能合约调用逻辑
- 实现应收账款的完整生命周期管理
- 提供实时数据更新和交易状态追踪

---

## 🛠️ 技术栈

- **框架**: React 18+
- **构建工具**: Vite
- **样式**: TailwindCSS + DaisyUI
- **Web3库**: ethers.js（仅用于签名验证）
- **状态管理**: Zustand
- **路由**: React Router v6
- **HTTP客户端**: Axios（主要交互方式）
- **UI组件**: 
  - React Icons
  - React Hot Toast (消息提示)
  - React Loading Skeleton (骨架屏)

---

## 🏗️ 项目结构

```
frontend/
├── public/
│   └── favicon.ico
├── src/
│   ├── assets/              # 静态资源
│   ├── components/          # 公共组件
│   │   ├── Layout/
│   │   │   ├── Header.jsx
│   │   │   ├── Sidebar.jsx
│   │   │   └── Footer.jsx
│   │   ├── Wallet/
│   │   │   └── WalletConnect.jsx
│   │   ├── Receivable/
│   │   │   ├── ReceivableCard.jsx
│   │   │   ├── ReceivableList.jsx
│   │   │   └── ReceivableDetail.jsx
│   │   ├── Finance/
│   │   │   ├── FinanceApplicationCard.jsx
│   │   │   └── FinanceApplicationList.jsx
│   │   └── Common/
│   │       ├── Loading.jsx
│   │       ├── Modal.jsx
│   │       └── StatusBadge.jsx
│   ├── pages/               # 页面组件
│   │   ├── Dashboard.jsx
│   │   ├── CreateReceivable.jsx
│   │   ├── ConfirmReceivable.jsx
│   │   ├── TransferReceivable.jsx
│   │   ├── FinanceApply.jsx
│   │   ├── FinanceApprove.jsx
│   │   └── TransactionHistory.jsx
│   ├── services/            # 服务层
│   │   ├── authService.js       # 认证服务（签名登录）
│   │   ├── apiService.js        # API服务（主要）
│   │   └── walletService.js     # 钱包服务（仅签名）
│   ├── store/               # 状态管理
│   │   ├── walletStore.js
│   │   ├── receivableStore.js
│   │   └── financeStore.js
│   ├── hooks/               # 自定义 Hooks
│   │   ├── useWallet.js
│   │   ├── useContract.js
│   │   └── useReceivables.js
│   ├── utils/               # 工具函数
│   │   ├── formatters.js
│   │   ├── validators.js
│   │   └── constants.js
│   ├── config/              # 配置文件
│   │   └── contract.js
│   ├── App.jsx              # 应用入口
│   ├── main.jsx             # 主文件
│   └── index.css            # 全局样式
├── .env.example
├── vite.config.js
├── tailwind.config.js
├── package.json
└── README.md
```

---

## 🔧 核心功能实现

### 1. API 服务 (services/apiService.js)

**核心服务：前端通过HTTP API与后端交互，不直接调用智能合约**

```javascript
import axios from 'axios';

const API_BASE_URL = import.meta.env.VITE_API_URL;

class ApiService {
  constructor() {
    this.client = axios.create({
      baseURL: API_BASE_URL,
      timeout: 30000
    });

    // 请求拦截器：添加 Token
    this.client.interceptors.request.use(config => {
      const token = localStorage.getItem('token');
      if (token) {
        config.headers.Authorization = `Bearer ${token}`;
      }
      return config;
    });

    // 响应拦截器：统一错误处理
    this.client.interceptors.response.use(
      response => response.data,
      error => {
        if (error.response?.status === 401) {
          localStorage.removeItem('token');
          window.location.href = '/login';
        }
        return Promise.reject(error);
      }
    );
  }

  // ========== 认证相关 ==========
  
  async login(address, signature, message) {
    const data = await this.client.post('/api/auth/login', {
      address,
      signature,
      message
    });
    if (data.success) {
      localStorage.setItem('token', data.data.token);
    }
    return data;
  }

  async register(userData) {
    const data = await this.client.post('/api/auth/register', userData);
    return data;
  }

  async getCurrentUser() {
    const data = await this.client.get('/api/auth/me');
    return data;
  }

  // ========== 应收账款相关 ==========
  
  async getReceivables(params) {
    const data = await this.client.get('/api/receivables', { params });
    return data;
  }

  async getReceivableDetail(id) {
    const data = await this.client.get(`/api/receivables/${id}`);
    return data;
  }

  async createReceivable(receivableData) {
    const data = await this.client.post('/api/receivables', receivableData);
    return data;
  }

  async confirmReceivable(id) {
    const data = await this.client.post(`/api/receivables/${id}/confirm`);
    return data;
  }

  async transferReceivable(id, newOwner) {
    const data = await this.client.post(`/api/receivables/${id}/transfer`, {
      newOwner
    });
    return data;
  }

  // ========== 融资相关 ==========
  
  async getFinanceApplications(params) {
    const data = await this.client.get('/api/finance/applications', { params });
    return data;
  }

  async applyForFinance(applicationData) {
    const data = await this.client.post('/api/finance/apply', applicationData);
    return data;
  }

  async approveFinance(appId, approved) {
    const data = await this.client.post(`/api/finance/${appId}/approve`, {
      approved
    });
    return data;
  }

  // ========== 统计相关 ==========
  
  async getDashboardStats() {
    const data = await this.client.get('/api/stats/dashboard');
    return data;
  }

  async getTransactionHistory(params) {
    const data = await this.client.get('/api/transactions', { params });
    return data;
  }
}

export default new ApiService();
```

### 2. 认证服务 (services/authService.js)

**MetaMask仅用于签名验证身份，不用于交易**

```javascript
import { ethers } from 'ethers';
import apiService from './apiService';

class AuthService {
  // 检查 MetaMask 是否安装
  isMetaMaskInstalled() {
    return typeof window.ethereum !== 'undefined';
  }

  // 登录（通过签名验证身份）
  async login() {
    if (!this.isMetaMaskInstalled()) {
      throw new Error('请安装 MetaMask 钱包');
    }

    try {
      // 1. 连接钱包获取地址
      const provider = new ethers.BrowserProvider(window.ethereum);
      await provider.send("eth_requestAccounts", []);
      const signer = await provider.getSigner();
      const address = await signer.getAddress();

      // 2. 生成登录消息
      const timestamp = new Date().toISOString();
      const message = `登录到供应链金融系统\n地址: ${address}\n时间: ${timestamp}`;

      // 3. 请求用户签名（仅用于身份验证）
      const signature = await signer.signMessage(message);

      // 4. 发送到后端验证并获取 Token
      const result = await apiService.login(address, signature, message);

      if (result.success) {
        // 保存用户信息
        localStorage.setItem('userAddress', address);
        return {
          address,
          userInfo: result.data.userInfo
        };
      } else {
        throw new Error(result.message || '登录失败');
      }
    } catch (error) {
      console.error('登录失败:', error);
      throw error;
    }
  }

  // 注册
  async register(role, companyName, contactPerson, contactEmail) {
    if (!this.isMetaMaskInstalled()) {
      throw new Error('请安装 MetaMask 钱包');
    }

    try {
      const provider = new ethers.BrowserProvider(window.ethereum);
      await provider.send("eth_requestAccounts", []);
      const signer = await provider.getSigner();
      const address = await signer.getAddress();

      const result = await apiService.register({
        address,
        role,
        companyName,
        contactPerson,
        contactEmail
      });

      return result;
    } catch (error) {
      console.error('注册失败:', error);
      throw error;
    }
  }

  // 登出
  logout() {
    localStorage.removeItem('token');
    localStorage.removeItem('userAddress');
  }

  // 检查是否登录
  isAuthenticated() {
    return !!localStorage.getItem('token');
  }

  // 获取当前用户地址
  getCurrentAddress() {
    return localStorage.getItem('userAddress');
  }

  // 监听账户变化
  watchAccountChange(callback) {
    if (window.ethereum) {
      window.ethereum.on('accountsChanged', (accounts) => {
        if (accounts.length === 0) {
          this.logout();
          callback(null);
        } else {
          // 账户变化时需要重新登录
          this.logout();
          window.location.reload();
        }
      });
    }
  }
}

export default new AuthService();
```

### 3. 钱包状态管理 (store/walletStore.js)

```javascript
import { ethers } from 'ethers';
import web3Service from './web3Service';
import contractABI from '../contracts/SupplyChainFinance.json';

const CONTRACT_ADDRESS = import.meta.env.VITE_CONTRACT_ADDRESS;

class ContractService {
  constructor() {
    this.contract = null;
  }

  // 初始化合约实例
  async initContract() {
    if (!web3Service.signer) {
      throw new Error('请先连接钱包');
    }

    this.contract = new ethers.Contract(
      CONTRACT_ADDRESS,
      contractABI.abi,
      web3Service.signer
    );

    return this.contract;
  }

  // 获取只读合约实例
  getReadOnlyContract() {
    const provider = new ethers.JsonRpcProvider(import.meta.env.VITE_RPC_URL);
    return new ethers.Contract(CONTRACT_ADDRESS, contractABI.abi, provider);
  }

  // ========== 用户相关 ==========

  // 注册用户
  async registerUser(role, name) {
    await this.initContract();
    const tx = await this.contract.registerUser(role, name);
    return await tx.wait();
  }

  // 获取用户角色
  async getUserRole(address) {
    const contract = this.getReadOnlyContract();
    return await contract.getUserRole(address);
  }

  // ========== 应收账款相关 ==========

  // 创建应收账款
  async createReceivable(supplier, amount, dueTime, description, contractNumber) {
    await this.initContract();
    
    const amountWei = ethers.parseEther(amount.toString());
    const dueTimestamp = Math.floor(new Date(dueTime).getTime() / 1000);

    const tx = await this.contract.createReceivable(
      supplier,
      amountWei,
      dueTimestamp,
      description,
      contractNumber
    );

    return await tx.wait();
  }

  // 确认应收账款
  async confirmReceivable(id) {
    await this.initContract();
    const tx = await this.contract.confirmReceivable(id);
    return await tx.wait();
  }

  // 转让应收账款
  async transferReceivable(id, newOwner) {
    await this.initContract();
    const tx = await this.contract.transferReceivable(id, newOwner);
    return await tx.wait();
  }

  // 获取应收账款详情
  async getReceivable(id) {
    const contract = this.getReadOnlyContract();
    const receivable = await contract.getReceivable(id);
    
    return {
      id: receivable.id.toString(),
      issuer: receivable.issuer,
      owner: receivable.owner,
      supplier: receivable.supplier,
      amount: ethers.formatEther(receivable.amount),
      createTime: new Date(Number(receivable.createTime) * 1000),
      dueTime: new Date(Number(receivable.dueTime) * 1000),
      confirmed: receivable.confirmed,
      financed: receivable.financed,
      settled: receivable.settled,
      description: receivable.description,
      contractNumber: receivable.contractNumber
    };
  }

  // 获取用户拥有的应收账款
  async getReceivablesByOwner(address) {
    const contract = this.getReadOnlyContract();
    const ids = await contract.getReceivablesByOwner(address);
    return ids.map(id => id.toString());
  }

  // 获取用户发行的应收账款
  async getReceivablesByIssuer(address) {
    const contract = this.getReadOnlyContract();
    const ids = await contract.getReceivablesByIssuer(address);
    return ids.map(id => id.toString());
  }

  // ========== 融资相关 ==========

  // 申请融资
  async applyForFinance(receivableId, financier, financeAmount, interestRate) {
    await this.initContract();
    
    const amountWei = ethers.parseEther(financeAmount.toString());

    const tx = await this.contract.applyForFinance(
      receivableId,
      financier,
      amountWei,
      interestRate
    );

    return await tx.wait();
  }

  // 审批融资申请
  async approveFinanceApplication(appId, approve) {
    await this.initContract();
    const tx = await this.contract.approveFinanceApplication(appId, approve);
    return await tx.wait();
  }

  // 获取融资申请详情
  async getFinanceApplication(appId) {
    const contract = this.getReadOnlyContract();
    const app = await contract.getFinanceApplication(appId);
    
    return {
      receivableId: app.receivableId.toString(),
      applicant: app.applicant,
      financier: app.financier,
      applyTime: new Date(Number(app.applyTime) * 1000),
      financeAmount: ethers.formatEther(app.financeAmount),
      interestRate: app.interestRate.toString(),
      approved: app.approved,
      processed: app.processed
    };
  }

  // ========== 事件监听 ==========

  // 监听应收账款创建事件
  onReceivableCreated(callback) {
    const contract = this.getReadOnlyContract();
    contract.on('ReceivableCreated', (id, issuer, supplier, amount, event) => {
      callback({
        id: id.toString(),
        issuer,
        supplier,
        amount: ethers.formatEther(amount),
        event
      });
    });
  }

  // 监听应收账款确认事件
  onReceivableConfirmed(callback) {
    const contract = this.getReadOnlyContract();
    contract.on('ReceivableConfirmed', (id, confirmer, event) => {
      callback({
        id: id.toString(),
        confirmer,
        event
      });
    });
  }

  // 监听应收账款转让事件
  onReceivableTransferred(callback) {
    const contract = this.getReadOnlyContract();
    contract.on('ReceivableTransferred', (id, from, to, event) => {
      callback({
        id: id.toString(),
        from,
        to,
        event
      });
    });
  }
}

export default new ContractService();
```

### 3. 钱包状态管理 (store/walletStore.js)

```javascript
import { create } from 'zustand';
import web3Service from '../services/web3Service';
import contractService from '../services/contractService';

export const useWalletStore = create((set, get) => ({
  // 状态
  account: null,
  balance: '0',
  network: null,
  userRole: 0,
  userName: '',
  isConnected: false,
  isLoading: false,

  // 连接钱包
  connectWallet: async () => {
    set({ isLoading: true });
    try {
      const { account } = await web3Service.connectWallet();
      const balance = await web3Service.getBalance(account);
      const network = await web3Service.getNetwork();
      const userRole = await contractService.getUserRole(account);

      set({
        account,
        balance,
        network: network.name,
        userRole: Number(userRole),
        isConnected: true,
        isLoading: false
      });

      return true;
    } catch (error) {
      console.error('连接钱包失败:', error);
      set({ isLoading: false });
      return false;
    }
  },

  // 断开连接
  disconnect: () => {
    web3Service.disconnect();
    set({
      account: null,
      balance: '0',
      network: null,
      userRole: 0,
      userName: '',
      isConnected: false
    });
  },

  // 更新余额
  updateBalance: async () => {
    const { account } = get();
    if (account) {
      const balance = await web3Service.getBalance(account);
      set({ balance });
    }
  },

  // 注册用户
  registerUser: async (role, name) => {
    try {
      await contractService.registerUser(role, name);
      set({ userRole: role, userName: name });
      return true;
    } catch (error) {
      console.error('注册失败:', error);
      return false;
    }
  }
}));
```

### 4. 应收账款状态管理 (store/receivableStore.js)

```javascript
import { create } from 'zustand';
import contractService from '../services/contractService';
import apiService from '../services/apiService';

export const useReceivableStore = create((set, get) => ({
  // 状态
  receivables: [],
  currentReceivable: null,
  isLoading: false,

  // 获取应收账款列表
  fetchReceivables: async (address, type = 'owner') => {
    set({ isLoading: true });
    try {
      let ids;
      if (type === 'owner') {
        ids = await contractService.getReceivablesByOwner(address);
      } else {
        ids = await contractService.getReceivablesByIssuer(address);
      }

      const receivables = await Promise.all(
        ids.map(id => contractService.getReceivable(id))
      );

      set({ receivables, isLoading: false });
      return receivables;
    } catch (error) {
      console.error('获取应收账款失败:', error);
      set({ isLoading: false });
      return [];
    }
  },

  // 获取应收账款详情
  fetchReceivableDetail: async (id) => {
    set({ isLoading: true });
    try {
      const receivable = await contractService.getReceivable(id);
      set({ currentReceivable: receivable, isLoading: false });
      return receivable;
    } catch (error) {
      console.error('获取应收账款详情失败:', error);
      set({ isLoading: false });
      return null;
    }
  },

  // 创建应收账款
  createReceivable: async (data) => {
    try {
      const receipt = await contractService.createReceivable(
        data.supplier,
        data.amount,
        data.dueTime,
        data.description,
        data.contractNumber
      );
      return receipt;
    } catch (error) {
      console.error('创建应收账款失败:', error);
      throw error;
    }
  },

  // 确认应收账款
  confirmReceivable: async (id) => {
    try {
      const receipt = await contractService.confirmReceivable(id);
      // 更新本地状态
      const { receivables } = get();
      const updated = receivables.map(r => 
        r.id === id ? { ...r, confirmed: true } : r
      );
      set({ receivables: updated });
      return receipt;
    } catch (error) {
      console.error('确认应收账款失败:', error);
      throw error;
    }
  },

  // 转让应收账款
  transferReceivable: async (id, newOwner) => {
    try {
      const receipt = await contractService.transferReceivable(id, newOwner);
      // 更新本地状态
      const { receivables } = get();
      const updated = receivables.map(r => 
        r.id === id ? { ...r, owner: newOwner } : r
      );
      set({ receivables: updated });
      return receipt;
    } catch (error) {
      console.error('转让应收账款失败:', error);
      throw error;
    }
  }
}));
```

### 5. Dashboard 页面 (pages/Dashboard.jsx)

```jsx
import React, { useEffect, useState } from 'react';
import { useWalletStore } from '../store/walletStore';
import { useReceivableStore } from '../store/receivableStore';
import ReceivableCard from '../components/Receivable/ReceivableCard';
import { FaWallet, FaFileInvoiceDollar, FaCheckCircle, FaMoneyBillWave } from 'react-icons/fa';

const Dashboard = () => {
  const { account, balance, userRole } = useWalletStore();
  const { receivables, fetchReceivables, isLoading } = useReceivableStore();
  const [stats, setStats] = useState({
    total: 0,
    confirmed: 0,
    financed: 0,
    totalAmount: 0
  });

  useEffect(() => {
    if (account) {
      loadData();
    }
  }, [account]);

  useEffect(() => {
    if (receivables.length > 0) {
      calculateStats();
    }
  }, [receivables]);

  const loadData = async () => {
    await fetchReceivables(account, 'owner');
  };

  const calculateStats = () => {
    const total = receivables.length;
    const confirmed = receivables.filter(r => r.confirmed).length;
    const financed = receivables.filter(r => r.financed).length;
    const totalAmount = receivables.reduce((sum, r) => sum + parseFloat(r.amount), 0);

    setStats({ total, confirmed, financed, totalAmount });
  };

  const getRoleName = (role) => {
    const roles = ['未注册', '核心企业', '供应商', '金融机构'];
    return roles[role] || '未知';
  };

  return (
    <div className="container mx-auto px-4 py-8">
      {/* 用户信息卡片 */}
      <div className="bg-gradient-to-r from-blue-500 to-purple-600 rounded-lg shadow-lg p-6 text-white mb-8">
        <h2 className="text-2xl font-bold mb-4">欢迎回来！</h2>
        <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
          <div>
            <p className="text-sm opacity-90">钱包地址</p>
            <p className="font-mono text-sm">{account?.slice(0, 10)}...{account?.slice(-8)}</p>
          </div>
          <div>
            <p className="text-sm opacity-90">账户余额</p>
            <p className="text-xl font-bold">{parseFloat(balance).toFixed(4)} ETH</p>
          </div>
          <div>
            <p className="text-sm opacity-90">用户角色</p>
            <p className="text-xl font-bold">{getRoleName(userRole)}</p>
          </div>
        </div>
      </div>

      {/* 统计卡片 */}
      <div className="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
        <div className="bg-white rounded-lg shadow p-6">
          <div className="flex items-center justify-between">
            <div>
              <p className="text-gray-500 text-sm">总应收账款</p>
              <p className="text-2xl font-bold text-gray-800">{stats.total}</p>
            </div>
            <FaFileInvoiceDollar className="text-4xl text-blue-500" />
          </div>
        </div>

        <div className="bg-white rounded-lg shadow p-6">
          <div className="flex items-center justify-between">
            <div>
              <p className="text-gray-500 text-sm">已确认</p>
              <p className="text-2xl font-bold text-gray-800">{stats.confirmed}</p>
            </div>
            <FaCheckCircle className="text-4xl text-green-500" />
          </div>
        </div>

        <div className="bg-white rounded-lg shadow p-6">
          <div className="flex items-center justify-between">
            <div>
              <p className="text-gray-500 text-sm">已融资</p>
              <p className="text-2xl font-bold text-gray-800">{stats.financed}</p>
            </div>
            <FaMoneyBillWave className="text-4xl text-purple-500" />
          </div>
        </div>

        <div className="bg-white rounded-lg shadow p-6">
          <div className="flex items-center justify-between">
            <div>
              <p className="text-gray-500 text-sm">总金额</p>
              <p className="text-2xl font-bold text-gray-800">{stats.totalAmount.toFixed(2)}</p>
            </div>
            <FaWallet className="text-4xl text-orange-500" />
          </div>
        </div>
      </div>

      {/* 应收账款列表 */}
      <div className="bg-white rounded-lg shadow">
        <div className="p-6 border-b">
          <h3 className="text-xl font-bold text-gray-800">我的应收账款</h3>
        </div>
        <div className="p-6">
          {isLoading ? (
            <div className="text-center py-8">
              <div className="loading loading-spinner loading-lg"></div>
              <p className="mt-4 text-gray-500">加载中...</p>
            </div>
          ) : receivables.length === 0 ? (
            <div className="text-center py-8">
              <p className="text-gray-500">暂无应收账款</p>
            </div>
          ) : (
            <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
              {receivables.map(receivable => (
                <ReceivableCard key={receivable.id} receivable={receivable} />
              ))}
            </div>
          )}
        </div>
      </div>
    </div>
  );
};

export default Dashboard;
```

### 6. 创建应收账款页面 (pages/CreateReceivable.jsx)

```jsx
import React, { useState } from 'react';
import { useNavigate } from 'react-router-dom';
import { useReceivableStore } from '../store/receivableStore';
import toast from 'react-hot-toast';
import { ethers } from 'ethers';

const CreateReceivable = () => {
  const navigate = useNavigate();
  const { createReceivable } = useReceivableStore();
  const [isSubmitting, setIsSubmitting] = useState(false);
  const [formData, setFormData] = useState({
    supplier: '',
    amount: '',
    dueTime: '',
    description: '',
    contractNumber: ''
  });

  const handleChange = (e) => {
    const { name, value } = e.target;
    setFormData(prev => ({
      ...prev,
      [name]: value
    }));
  };

  const handleSubmit = async (e) => {
    e.preventDefault();

    // 表单验证
    if (!ethers.isAddress(formData.supplier)) {
      toast.error('无效的供应商地址');
      return;
    }

    if (parseFloat(formData.amount) <= 0) {
      toast.error('金额必须大于0');
      return;
    }

    if (new Date(formData.dueTime) <= new Date()) {
      toast.error('到期时间必须在未来');
      return;
    }

    setIsSubmitting(true);
    const loadingToast = toast.loading('正在创建应收账款...');

    try {
      const receipt = await createReceivable(formData);
      toast.success('应收账款创建成功！', { id: loadingToast });
      navigate('/dashboard');
    } catch (error) {
      console.error('创建失败:', error);
      toast.error(error.message || '创建失败，请重试', { id: loadingToast });
    } finally {
      setIsSubmitting(false);
    }
  };

  return (
    <div className="container mx-auto px-4 py-8">
      <div className="max-w-2xl mx-auto">
        <div className="bg-white rounded-lg shadow-lg p-8">
          <h2 className="text-2xl font-bold text-gray-800 mb-6">创建应收账款</h2>

          <form onSubmit={handleSubmit} className="space-y-6">
            {/* 供应商地址 */}
            <div>
              <label className="block text-sm font-medium text-gray-700 mb-2">
                供应商钱包地址 *
              </label>
              <input
                type="text"
                name="supplier"
                value={formData.supplier}
                onChange={handleChange}
                placeholder="0x..."
                className="input input-bordered w-full"
                required
              />
            </div>

            {/* 金额 */}
            <div>
              <label className="block text-sm font-medium text-gray-700 mb-2">
                金额 (ETH) *
              </label>
              <input
                type="number"
                name="amount"
                value={formData.amount}
                onChange={handleChange}
                placeholder="0.00"
                step="0.01"
                min="0"
                className="input input-bordered w-full"
                required
              />
            </div>

            {/* 到期时间 */}
            <div>
              <label className="block text-sm font-medium text-gray-700 mb-2">
                到期时间 *
              </label>
              <input
                type="datetime-local"
                name="dueTime"
                value={formData.dueTime}
                onChange={handleChange}
                className="input input-bordered w-full"
                required
              />
            </div>

            {/* 合同编号 */}
            <div>
              <label className="block text-sm font-medium text-gray-700 mb-2">
                合同编号 *
              </label>
              <input
                type="text"
                name="contractNumber"
                value={formData.contractNumber}
                onChange={handleChange}
                placeholder="CONTRACT-001"
                className="input input-bordered w-full"
                required
              />
            </div>

            {/* 描述 */}
            <div>
              <label className="block text-sm font-medium text-gray-700 mb-2">
                描述 *
              </label>
              <textarea
                name="description"
                value={formData.description}
                onChange={handleChange}
                placeholder="请输入应收账款描述..."
                rows="4"
                className="textarea textarea-bordered w-full"
                required
              />
            </div>

            {/* 按钮组 */}
            <div className="flex gap-4">
              <button
                type="submit"
                disabled={isSubmitting}
                className="btn btn-primary flex-1"
              >
                {isSubmitting ? '创建中...' : '创建应收账款'}
              </button>
              <button
                type="button"
                onClick={() => navigate('/dashboard')}
                className="btn btn-ghost"
              >
                取消
              </button>
            </div>
          </form>
        </div>
      </div>
    </div>
  );
};

export default CreateReceivable;
```

---

## 🎨 样式配置

### tailwind.config.js

```javascript
/** @type {import('tailwindcss').Config} */
export default {
  content: [
    "./index.html",
    "./src/**/*.{js,ts,jsx,tsx}",
  ],
  theme: {
    extend: {},
  },
  plugins: [require("daisyui")],
  daisyui: {
    themes: ["light", "dark", "cupcake"],
  },
}
```

### vite.config.js

```javascript
import { defineConfig } from 'vite'
import react from '@vitejs/plugin-react'

export default defineConfig({
  plugins: [react()],
  server: {
    port: 3000,
    proxy: {
      '/api': {
        target: 'http://localhost:5000',
        changeOrigin: true
      }
    }
  }
})
```

---

## 📝 开发步骤

1. **初始化项目** (15分钟)
   ```bash
   npm create vite@latest frontend -- --template react
   cd frontend
   npm install
   npm install ethers zustand react-router-dom axios
   npm install -D tailwindcss daisyui postcss autoprefixer
   npx tailwindcss init -p
   ```

2. **配置 TailwindCSS** (10分钟)

3. **创建项目结构** (15分钟)

4. **实现 Web3 服务** (1小时)

5. **实现状态管理** (1小时)

6. **开发页面组件** (3-4小时)
   - Dashboard
   - CreateReceivable
   - ConfirmReceivable
   - TransferReceivable
   - FinanceApply
   - FinanceApprove

7. **开发公共组件** (1.5小时)

8. **配置路由** (30分钟)

9. **测试和调试** (1小时)

**预计总时间：8-10小时**

---

## 🎁 交付物

- [x] 完整的 React 前端项目
- [x] 钱包连接功能
- [x] 所有业务页面
- [x] 响应式设计
- [x] 错误处理和加载状态
- [x] 用户友好的交互提示

---

## ⚠️ 注意事项

1. **MetaMask 检测**: 启动时检查是否安装 MetaMask
2. **网络切换**: 提示用户切换到正确的网络
3. **交易确认**: 等待交易确认后更新 UI
4. **错误处理**: 友好的错误提示信息
5. **加载状态**: 所有异步操作都要显示加载状态
6. **响应式设计**: 适配移动端和桌面端

---

## 🔗 相关资源

- React: https://react.dev
- Vite: https://vitejs.dev
- TailwindCSS: https://tailwindcss.com
- DaisyUI: https://daisyui.com
- Zustand: https://zustand-demo.pmnd.rs
- ethers.js: https://docs.ethers.org

